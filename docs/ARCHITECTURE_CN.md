# æ¶æ„æ–‡æ¡£

## ç³»ç»Ÿæ¦‚è¿°

AIæ—¥è®°æ˜¯ä¸€ä¸ªäº‘åŸç”Ÿå…¨æ ˆWebåº”ç”¨ï¼Œä¸ºç”¨æˆ·æä¾›æ™ºèƒ½æ—¥è®°ä½“éªŒã€‚ç³»ç»Ÿåˆ©ç”¨Reactã€FastAPIã€Firebaseã€OpenAIå’ŒWeaviateç­‰ç°ä»£æŠ€æœ¯ï¼ŒåŸºäºæ—¥è®°å†å²æä¾›ä¸ªæ€§åŒ–AIæ´å¯Ÿã€‚

## é«˜å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·æµè§ˆå™¨                             â”‚
â”‚                  (React + TypeScript + Tailwind)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ HTTPS
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Cloud Run - å‰ç«¯                           â”‚
â”‚                   (é™æ€å†…å®¹æœåŠ¡)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ REST API
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Cloud Run - åç«¯                           â”‚
â”‚                      (FastAPI)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  APIå±‚ (FastAPIè·¯ç”±)                               â”‚    â”‚
â”‚  â”‚  - èº«ä»½éªŒè¯ä¸­é—´ä»¶                                   â”‚    â”‚
â”‚  â”‚  - è¯·æ±‚éªŒè¯                                        â”‚    â”‚
â”‚  â”‚  - é”™è¯¯å¤„ç†                                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  æœåŠ¡å±‚                                             â”‚    â”‚
â”‚  â”‚  - æ—¥è®°æœåŠ¡ (CRUDæ“ä½œ)                             â”‚    â”‚
â”‚  â”‚  - RAGæœåŠ¡ (AIæ´å¯Ÿç”Ÿæˆ)                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                     â”‚
          â”‚                                     â”‚
     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
     â”‚Firebase â”‚                          â”‚ Weaviate â”‚
     â”‚ Auth &  â”‚                          â”‚  å‘é‡    â”‚
     â”‚Firestoreâ”‚                          â”‚  æ•°æ®åº“   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                                          â”‚  OpenAI  â”‚
                                          â”‚   API    â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç»„ä»¶è¯¦è§£

### 1. å‰ç«¯ (React + TypeScript)

**æŠ€æœ¯æ ˆï¼š**
- React 18 with TypeScript
- Vite æ„å»ºå·¥å…·
- Tailwind CSS æ ·å¼
- Zustand çŠ¶æ€ç®¡ç†
- React Router è·¯ç”±å¯¼èˆª
- Axios HTTPè¯·æ±‚
- Firebase SDK èº«ä»½éªŒè¯

**æ ¸å¿ƒç»„ä»¶ï¼š**

```
src/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ Login.tsx          # èº«ä»½éªŒè¯é¡µé¢
â”‚   â”œâ”€â”€ Dashboard.tsx      # æ—¥è®°åˆ—è¡¨è§†å›¾
â”‚   â””â”€â”€ DiaryEditor.tsx    # åˆ›å»º/ç¼–è¾‘æ—¥è®°
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ client.ts          # å¸¦è®¤è¯æ‹¦æˆªå™¨çš„Axioså®ä¾‹
â”‚   â””â”€â”€ diaries.ts         # æ—¥è®°APIç«¯ç‚¹
â”œâ”€â”€ store/
â”‚   â””â”€â”€ authStore.ts       # å…¨å±€è®¤è¯çŠ¶æ€
â”œâ”€â”€ config/
â”‚   â””â”€â”€ firebase.ts        # Firebaseåˆå§‹åŒ–
â””â”€â”€ types/
    â””â”€â”€ diary.ts           # TypeScriptæ¥å£
```

**èº«ä»½éªŒè¯æµç¨‹ï¼š**
1. ç”¨æˆ·è¾“å…¥å‡­æ®
2. Firebase AuthéªŒè¯å¹¶è¿”å›IDä»¤ç‰Œ
3. ä»¤ç‰Œå­˜å‚¨åœ¨å†…å­˜ä¸­å¹¶é™„åŠ åˆ°æ‰€æœ‰APIè¯·æ±‚
4. åç«¯åœ¨æ¯ä¸ªè¯·æ±‚ä¸ŠéªŒè¯ä»¤ç‰Œ

### 2. åç«¯ (FastAPI)

**æŠ€æœ¯æ ˆï¼š**
- FastAPI (Python 3.11)
- Firebase Admin SDK
- OpenAI Python SDK
- Weaviate Pythonå®¢æˆ·ç«¯
- Pydantic æ•°æ®éªŒè¯
- Uvicorn ASGIæœåŠ¡å™¨

**æ¶æ„å±‚æ¬¡ï¼š**

```
app/
â”œâ”€â”€ main.py                    # FastAPIåº”ç”¨å…¥å£
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ dependencies.py        # è®¤è¯ä¾èµ–æ³¨å…¥
â”‚   â””â”€â”€ routes/
â”‚       â””â”€â”€ diaries.py         # æ—¥è®°ç«¯ç‚¹
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ diary_service.py       # ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ rag_service.py         # RAGå®ç°
â”œâ”€â”€ models/
â”‚   â””â”€â”€ diary.py               # Pydanticæ¨¡å‹
â””â”€â”€ core/
    â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†
    â”œâ”€â”€ firebase.py            # Firebaseå®¢æˆ·ç«¯
    â””â”€â”€ weaviate_client.py     # Weaviateå®¢æˆ·ç«¯
```

**APIç«¯ç‚¹ï¼š**

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | éœ€è¦è®¤è¯ |
|--------|----------|-------------|---------------|
| GET | `/` | APIä¿¡æ¯ | å¦ |
| GET | `/health` | å¥åº·æ£€æŸ¥ | å¦ |
| GET | `/diaries` | åˆ—å‡ºç”¨æˆ·æ—¥è®° | æ˜¯ |
| POST | `/diaries` | åˆ›å»ºæ—¥è®° | æ˜¯ |
| GET | `/diaries/{id}` | è·å–æ—¥è®° | æ˜¯ |
| PUT | `/diaries/{id}` | æ›´æ–°æ—¥è®° | æ˜¯ |
| DELETE | `/diaries/{id}` | åˆ é™¤æ—¥è®° | æ˜¯ |
| POST | `/diaries/{id}/ai-insight` | ç”ŸæˆAIæ´å¯Ÿ | æ˜¯ |

### 3. èº«ä»½éªŒè¯ä¸æˆæƒ

**Firebase Authenticationï¼š**
- é‚®ç®±/å¯†ç èº«ä»½éªŒè¯
- åŸºäºJWTä»¤ç‰Œçš„ä¼šè¯ç®¡ç†
- å®‰å…¨ä»¤ç‰Œåˆ·æ–°æœºåˆ¶

**åç«¯éªŒè¯ï¼š**
```python
# ä¸­é—´ä»¶éªŒè¯Firebase IDä»¤ç‰Œ
async def get_current_user(credentials: HTTPAuthorizationCredentials):
    token = credentials.credentials
    decoded_token = firebase_auth.verify_id_token(token)
    return decoded_token  # åŒ…å«uidã€emailç­‰
```

**æˆæƒï¼š**
- ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ—¥è®°
- Firestoreå®‰å…¨è§„åˆ™å¼ºåˆ¶è®¿é—®æ§åˆ¶
- åç«¯åœ¨æ‰€æœ‰æ“ä½œä¸ŠåŒé‡æ£€æŸ¥æ‰€æœ‰æƒ

### 4. æ•°æ®å­˜å‚¨

#### Firestore (ä¸»æ•°æ®åº“)

**æ¨¡å¼ï¼š**
```javascript
// é›†åˆ: diaries
{
  "diaryId": "auto-generated",
  "userId": "firebase-uid",
  "title": "string",
  "content": "string",
  "createdAt": "timestamp",
  "updatedAt": "timestamp",
  "aiInsight": "string | null"
}
```

**ç´¢å¼•ï¼š**
- å¤åˆç´¢å¼•: (userId, createdAt DESC)
- å•å­—æ®µ: userId

**å®‰å…¨è§„åˆ™ï¼š**
```javascript
// ç”¨æˆ·åªèƒ½è¯»å†™è‡ªå·±çš„æ—¥è®°
match /diaries/{diaryId} {
  allow read, write: if request.auth.uid == resource.data.userId;
}
```

#### Weaviate (å‘é‡æ•°æ®åº“)

**ç”¨é€”ï¼š** RAGçš„è¯­ä¹‰æœç´¢

**æ¨¡å¼ï¼š**
```javascript
{
  "class": "DiaryEntry",
  "properties": [
    {"name": "diaryId", "dataType": ["string"]},
    {"name": "userId", "dataType": ["string"]},
    {"name": "title", "dataType": ["string"]},
    {"name": "content", "dataType": ["text"]},
    {"name": "createdAt", "dataType": ["string"]}
  ]
}
```

**å‘é‡åµŒå…¥ï¼š**
- ä½¿ç”¨OpenAIçš„ `text-embedding-ada-002` ç”Ÿæˆ
- è¾“å…¥: `{title}\n\n{content}`
- ç»´åº¦: 1536

### 5. RAGç³»ç»Ÿ (æ£€ç´¢å¢å¼ºç”Ÿæˆ)

**æ¶æ„ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RAGç®¡é“                               â”‚
â”‚                                                          â”‚
â”‚  1. ç”¨æˆ·è¯·æ±‚æ—¥è®°Xçš„AIæ´å¯Ÿ                               â”‚
â”‚           â”‚                                              â”‚
â”‚           â–¼                                              â”‚
â”‚  2. ä¸ºæ—¥è®°Xå†…å®¹ç”ŸæˆåµŒå…¥                                 â”‚
â”‚           â”‚ (OpenAI text-embedding-ada-002)             â”‚
â”‚           â–¼                                              â”‚
â”‚  3. åœ¨Weaviateä¸­æœç´¢ç›¸ä¼¼çš„å†å²æ—¥è®°                     â”‚
â”‚           â”‚ (å‘é‡ç›¸ä¼¼åº¦æœç´¢)                             â”‚
â”‚           â–¼                                              â”‚
â”‚  4. æ£€ç´¢æœ€ç›¸ä¼¼çš„å‰3ç¯‡æ—¥è®°                               â”‚
â”‚           â”‚                                              â”‚
â”‚           â–¼                                              â”‚
â”‚  5. æ„å»ºåŒ…å«å½“å‰+å†å²æ—¥è®°çš„ä¸Šä¸‹æ–‡                       â”‚
â”‚           â”‚                                              â”‚
â”‚           â–¼                                              â”‚
â”‚  6. ä½¿ç”¨GPT-3.5ç”Ÿæˆæ´å¯Ÿ                                 â”‚
â”‚           â”‚ (OpenAIèŠå¤©å®Œæˆ)                            â”‚
â”‚           â–¼                                              â”‚
â”‚  7. å°†æ´å¯Ÿå­˜å‚¨åœ¨Firestoreä¸­                             â”‚
â”‚           â”‚                                              â”‚
â”‚           â–¼                                              â”‚
â”‚  8. å°†æ´å¯Ÿè¿”å›ç»™ç”¨æˆ·                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°ç»†èŠ‚ï¼š**

```python
async def generate_insight(current_diary, user_id):
    # 1. åµŒå…¥å½“å‰æ—¥è®°
    embedding = openai.embeddings.create(
        model="text-embedding-ada-002",
        input=f"{current_diary.title}\n\n{current_diary.content}"
    )
    
    # 2. æœç´¢ç›¸ä¼¼æ—¥è®°
    similar = weaviate.query.get("DiaryEntry")
        .with_near_vector({"vector": embedding.data[0].embedding})
        .with_where({"path": ["userId"], "operator": "Equal", "valueString": user_id})
        .with_limit(5)
        .do()
    
    # 3. æ„å»ºä¸Šä¸‹æ–‡
    context = build_context(current_diary, similar)
    
    # 4. ç”Ÿæˆæ´å¯Ÿ
    response = openai.chat.completions.create(
        model="gpt-3.5-turbo",
        messages=[
            {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªå¯Œæœ‰åŒæƒ…å¿ƒçš„AIæ—¥è®°ä¼´ä¾£..."},
            {"role": "user", "content": context}
        ]
    )
    
    return response.choices[0].message.content
```

**æç¤ºå·¥ç¨‹ï¼š**
- ç³»ç»Ÿæç¤ºå®šä¹‰AIè§’è‰²ï¼ˆå¯Œæœ‰åŒæƒ…å¿ƒçš„ä¼´ä¾£ï¼‰
- ç”¨æˆ·æç¤ºåŒ…æ‹¬å½“å‰æ¡ç›® + è¿‡å»ç›¸ä¼¼æ¡ç›®
- æ¸©åº¦ï¼š0.7ï¼ˆå¹³è¡¡åˆ›é€ æ€§/ä¸€è‡´æ€§ï¼‰
- æœ€å¤§ä»¤ç‰Œï¼š200ï¼ˆç®€æ´çš„æ´å¯Ÿï¼‰

### 6. åŸºç¡€è®¾æ–½ (GCP)

**ä½¿ç”¨çš„æœåŠ¡ï¼š**

| æœåŠ¡ | ç”¨é€” | é…ç½® |
|---------|---------|---------------|
| Cloud Run | æ— æœåŠ¡å™¨å®¹å™¨æ‰˜ç®¡ | è‡ªåŠ¨æ‰©å±•0-10å®ä¾‹ |
| Artifact Registry | Dockeré•œåƒå­˜å‚¨ | åŒºåŸŸå­˜å‚¨åº“ |
| Firestore | ä¸»æ•°æ®åº“ | åŸç”Ÿæ¨¡å¼ï¼Œus-central |
| Firebase Auth | ç”¨æˆ·è®¤è¯ | é‚®ç®±/å¯†ç æä¾›å•† |
| Cloud Build | CI/CDç®¡é“ | è‡ªåŠ¨åŒ–éƒ¨ç½² |
| Cloud Logging | é›†ä¸­å¼æ—¥å¿— | 30å¤©ä¿ç•™ |

**ç½‘ç»œæ¶æ„ï¼š**
- æ‰€æœ‰æœåŠ¡é€šè¿‡HTTPSé€šä¿¡
- Cloud RunæœåŠ¡æœ‰å†…éƒ¨URL
- å‰ç«¯å’Œåç«¯æœ‰å…¬å…±URL
- Weaviateä»…å†…éƒ¨è®¿é—®ï¼ˆç”±åç«¯è®¿é—®ï¼‰

**å®‰å…¨æ€§ï¼š**
- å…·æœ‰æœ€å°æƒé™çš„æœåŠ¡è´¦å·
- å¯†é’¥å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­
- æ‰€æœ‰é€šä¿¡ä½¿ç”¨TLS/SSL
- ä¸ºå‰ç«¯åŸŸé…ç½®CORS
- å¼ºåˆ¶æ‰§è¡ŒFirestoreå®‰å…¨è§„åˆ™

### 7. CI/CDç®¡é“

**GitHub Actionså·¥ä½œæµï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ¨é€åˆ°mainåˆ†æ”¯                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  è¿è¡Œæµ‹è¯•            â”‚
         â”‚  - æ£€æŸ¥å‰ç«¯          â”‚
         â”‚  - æ£€æŸ¥åç«¯          â”‚
         â”‚  - æ„å»ºæ£€æŸ¥          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  æ„å»ºé•œåƒ            â”‚
         â”‚  - åç«¯Docker        â”‚
         â”‚  - å‰ç«¯Docker        â”‚
         â”‚  - ç”¨SHAæ ‡è®°         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  æ¨é€åˆ°ä»“åº“          â”‚
         â”‚  - Artifact Registry â”‚
         â”‚  - æ ‡è®°latest        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  éƒ¨ç½²åˆ°Cloud Run     â”‚
         â”‚  - æ›´æ–°åç«¯          â”‚
         â”‚  - æ›´æ–°å‰ç«¯          â”‚
         â”‚  - å¥åº·æ£€æŸ¥          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  é€šçŸ¥æˆåŠŸ            â”‚
         â”‚  - è·å–æœåŠ¡URL       â”‚
         â”‚  - æ›´æ–°çŠ¶æ€          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ•°æ®æµ

### åˆ›å»ºæ—¥è®°æ¡ç›®

```
1. ç”¨æˆ·åœ¨å‰ç«¯å†™æ—¥è®°
2. å‰ç«¯POSTåˆ°/diariesï¼Œæºå¸¦æ ‡é¢˜å’Œå†…å®¹
3. åç«¯éªŒè¯Firebaseä»¤ç‰Œ
4. åç«¯ä¿å­˜åˆ°Firestore
5. åç«¯åˆ›å»ºåµŒå…¥å¹¶å­˜å‚¨åœ¨Weaviate
6. åç«¯è¿”å›æ—¥è®°å¯¹è±¡ç»™å‰ç«¯
7. å‰ç«¯ç”¨æ–°æ—¥è®°æ›´æ–°UI
```

### ç”ŸæˆAIæ´å¯Ÿ

```
1. ç”¨æˆ·ç‚¹å‡»"è·å–AIæ´å¯Ÿ"æŒ‰é’®
2. å‰ç«¯POSTåˆ°/diaries/{id}/ai-insight
3. åç«¯ä»Firestoreæ£€ç´¢æ—¥è®°
4. åç«¯ä¸ºæ—¥è®°ç”ŸæˆåµŒå…¥
5. åç«¯åœ¨Weaviateä¸­æœç´¢ç›¸ä¼¼çš„å†å²æ—¥è®°
6. åç«¯æ„å»ºåŒ…å«å½“å‰+å†å²æ—¥è®°çš„ä¸Šä¸‹æ–‡
7. åç«¯è°ƒç”¨OpenAIç”Ÿæˆæ´å¯Ÿ
8. åç«¯åœ¨Firestoreä¸­å­˜å‚¨æ´å¯Ÿ
9. åç«¯è¿”å›æ´å¯Ÿç»™å‰ç«¯
10. å‰ç«¯å‘ç”¨æˆ·æ˜¾ç¤ºæ´å¯Ÿ
```

## æ€§èƒ½è€ƒè™‘

### ç¼“å­˜ç­–ç•¥
- å‰ç«¯ï¼šReactç»„ä»¶è®°å¿†åŒ–
- åç«¯ï¼šWeaviateå®¢æˆ·ç«¯è¿æ¥æ± 
- æ•°æ®åº“ï¼šFirestoreè‡ªåŠ¨ç¼“å­˜

### ä¼˜åŒ–
- å‰ç«¯ï¼šä»£ç åˆ†å‰²ï¼Œæ‡’åŠ è½½
- åç«¯ï¼šå…¨ç¨‹å¼‚æ­¥/ç­‰å¾…
- æ•°æ®åº“ï¼šç´¢å¼•æŸ¥è¯¢ï¼Œæ‰¹é‡æ“ä½œ
- CDNï¼šCloud Runè‡ªåŠ¨è¾¹ç¼˜ç¼“å­˜

### å¯æ‰©å±•æ€§
- æ¨ªå‘ï¼šCloud Runè‡ªåŠ¨æ‰©å±•
- çºµå‘ï¼šå¯é…ç½®CPU/å†…å­˜é™åˆ¶
- æ•°æ®åº“ï¼šFirestoreå¤„ç†æ•°ç™¾ä¸‡æ¬¡æ“ä½œ
- å‘é‡æ•°æ®åº“ï¼šWeaviateéšæ•°æ®é‡æ‰©å±•

## ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### æ—¥å¿—
- æ‰€æœ‰æœåŠ¡çš„Cloud Logging
- ç»“æ„åŒ–JSONæ—¥å¿—
- è¯·æ±‚/å“åº”æ—¥å¿—
- é”™è¯¯å †æ ˆè·Ÿè¸ª

### æŒ‡æ ‡
- Cloud Runå†…ç½®æŒ‡æ ‡
- è¯·æ±‚è®¡æ•°ã€å»¶è¿Ÿã€é”™è¯¯
- å†·å¯åŠ¨è·Ÿè¸ª
- æˆæœ¬ç›‘æ§

### è­¦æŠ¥
- é”™è¯¯ç‡é˜ˆå€¼
- å“åº”æ—¶é—´SLA
- æˆæœ¬é¢„ç®—è­¦æŠ¥
- é…é¢ç›‘æ§

## å®‰å…¨æ¶æ„

### æ·±åº¦é˜²å¾¡
1. **ç½‘ç»œ**ï¼šä»…HTTPSï¼ŒCORSé™åˆ¶
2. **èº«ä»½éªŒè¯**ï¼šFirebase JWTéªŒè¯
3. **æˆæƒ**ï¼šç”¨æˆ·ç‰¹å®šæ•°æ®è®¿é—®
4. **æ•°æ®åº“**ï¼šå®‰å…¨è§„åˆ™å¼ºåˆ¶æ‰§è¡Œ
5. **å¯†é’¥**ï¼šç¯å¢ƒå˜é‡ï¼Œæ— ç¡¬ç¼–ç 
6. **åŸºç¡€è®¾æ–½**ï¼šIAMè§’è‰²ï¼ŒæœåŠ¡è´¦å·

### æ•°æ®ä¿æŠ¤
- ä¼ è¾“ä¸­ï¼šTLS 1.2+
- é™æ€ï¼šGCPé»˜è®¤åŠ å¯†
- å¤‡ä»½ï¼šFirestoreè‡ªåŠ¨
- å®¡è®¡ï¼šCloud Logging

## ç¾éš¾æ¢å¤

### å¤‡ä»½ç­–ç•¥
- Firestoreï¼šè‡ªåŠ¨æ¯æ—¥å¤‡ä»½
- Weaviateï¼šå·å¿«ç…§ï¼ˆå¦‚æœæŒä¹…åŒ–ï¼‰
- ä»£ç ï¼šGitç‰ˆæœ¬æ§åˆ¶
- åŸºç¡€è®¾æ–½ï¼šTerraformçŠ¶æ€

### æ¢å¤ç¨‹åº
1. æœåŠ¡ä¸­æ–­ï¼šCloud Runè‡ªåŠ¨é‡å¯
2. æ•°æ®æŸåï¼šä»Firestoreå¤‡ä»½æ¢å¤
3. å®Œå…¨æ•…éšœï¼šTerraformé‡æ–°éƒ¨ç½²
4. å›æ»šï¼šéƒ¨ç½²ä¹‹å‰çš„å®¹å™¨é•œåƒ

## æœªæ¥å¢å¼º

### è®¡åˆ’åŠŸèƒ½
- ç§»åŠ¨åº”ç”¨ï¼ˆReact Nativeï¼‰
- é«˜çº§åˆ†æä»ªè¡¨æ¿
- å¯¼å‡ºæ—¥è®°ä¸ºPDF
- è¯­éŸ³è½¬æ–‡å­—æ—¥è®°è¾“å…¥
- å¤šè¯­è¨€æ”¯æŒ
- æƒ…æ„Ÿåˆ†æ
- æ¯æ—¥æé†’é€šçŸ¥

### å¯æ‰©å±•æ€§æ”¹è¿›
- Redisç¼“å­˜å±‚
- GraphQL API
- é™æ€èµ„æºCDN
- å¤šåŒºåŸŸéƒ¨ç½²
- æ•°æ®åº“åˆ†ç‰‡

### AIå¢å¼º
- åœ¨ç”¨æˆ·æ•°æ®ä¸Šå¾®è°ƒæ¨¡å‹
- æ—¶é—´è½´æƒ…ç»ªè·Ÿè¸ª
- ç›®æ ‡è®¾å®šå’Œè·Ÿè¸ª
- å†™ä½œæç¤ºå»ºè®®
- ä¸»é¢˜æ£€æµ‹

## ç»“è®º

è¿™ä¸ªæ¶æ„ä¸ºAIæ—¥è®°åº”ç”¨æä¾›äº†å¯æ‰©å±•ã€å®‰å…¨å’Œå¯ç»´æŠ¤çš„åŸºç¡€ã€‚ä½¿ç”¨ç°ä»£äº‘åŸç”ŸæŠ€æœ¯ç¡®ä¿å¯é æ€§å’Œæ€§èƒ½ï¼Œè€ŒRAGç³»ç»Ÿæä¾›éšæ—¶é—´æ”¹è¿›çš„ä¸ªæ€§åŒ–AIæ´å¯Ÿã€‚

## æŠ€æœ¯å†³ç­–

### ä¸ºä»€ä¹ˆé€‰æ‹©è¿™äº›æŠ€æœ¯ï¼Ÿ

**React + TypeScript**
- å¼ºç±»å‹ç³»ç»Ÿå‡å°‘é”™è¯¯
- å¤§å‹ç¤¾åŒºå’Œç”Ÿæ€ç³»ç»Ÿ
- ä¼˜ç§€çš„å¼€å‘è€…ä½“éªŒ

**FastAPI**
- è‡ªåŠ¨APIæ–‡æ¡£
- åŸç”Ÿasync/awaitæ”¯æŒ
- Pydanticæ•°æ®éªŒè¯
- é«˜æ€§èƒ½

**Firebase**
- æ˜“äºé›†æˆçš„è®¤è¯
- å®æ—¶æ•°æ®åŒæ­¥
- æ‰˜ç®¡åŸºç¡€è®¾æ–½
- è‡ªåŠ¨æ‰©å±•

**Weaviate**
- ä¸“ä¸ºå‘é‡æœç´¢ä¼˜åŒ–
- æ˜“äºé›†æˆOpenAI
- è‰¯å¥½çš„æ€§èƒ½
- å¼€æº

**Cloud Run**
- æ— æœåŠ¡å™¨ï¼Œæ— éœ€ç®¡ç†æœåŠ¡å™¨
- æŒ‰ä½¿ç”¨ä»˜è´¹
- è‡ªåŠ¨æ‰©å±•åˆ°é›¶
- å®¹å™¨åŒ–åº”ç”¨

**Terraform**
- åŸºç¡€è®¾æ–½å³ä»£ç 
- ç‰ˆæœ¬æ§åˆ¶
- å¯é‡å¤éƒ¨ç½²
- å¤šç¯å¢ƒç®¡ç†

## æˆæœ¬ä¼˜åŒ–

### å¼€å‘ç¯å¢ƒ
- ä½¿ç”¨docker-composeï¼ˆå…è´¹ï¼‰
- æœ€å°Cloud Runå®ä¾‹
- Firestoreå…è´¹å±‚
- OpenAIä½¿ç”¨é™åˆ¶

### ç”Ÿäº§ç¯å¢ƒ
- Cloud Runæœ€å°å®ä¾‹è®¾ä¸º0
- åˆç†çš„å†…å­˜/CPUé™åˆ¶
- FirestoreæŸ¥è¯¢ä¼˜åŒ–
- ç¼“å­˜ç­–ç•¥
- ç›‘æ§æˆæœ¬ä»ªè¡¨æ¿

### é¢„ä¼°æˆæœ¬ï¼ˆæœˆåº¦ï¼‰

| æœåŠ¡ | ç”¨é‡ | æˆæœ¬ |
|------|------|------|
| Cloud Run | å°æµé‡ | $5-20 |
| Firestore | < 50Kæ“ä½œ | $0-5 |
| OpenAI API | 100è¯·æ±‚ | $2-5 |
| Weaviate | Cloud Runæ‰˜ç®¡ | $10-30 |
| **æ€»è®¡** | | **$20-60** |

*æ³¨ï¼šå®é™…æˆæœ¬å–å†³äºä½¿ç”¨é‡

## å¼€å‘æœ€ä½³å®è·µ

1. **ç‰ˆæœ¬æ§åˆ¶**ï¼šæ‰€æœ‰ä»£ç åœ¨Gitä¸­
2. **ä»£ç å®¡æŸ¥**ï¼šä½¿ç”¨Pull Requests
3. **æµ‹è¯•**ï¼šå•å…ƒå’Œé›†æˆæµ‹è¯•
4. **æ–‡æ¡£**ï¼šå†…è”æ³¨é‡Šå’ŒREADME
5. **å®‰å…¨**ï¼šå®šæœŸä¾èµ–æ›´æ–°
6. **ç›‘æ§**ï¼šè®¾ç½®è­¦æŠ¥å’Œä»ªè¡¨æ¿
7. **å¤‡ä»½**ï¼šå®šæœŸæ•°æ®å¤‡ä»½

ç¥ä½ æ„å»ºå‡ºè‰²çš„åº”ç”¨ï¼ğŸš€

